
> stac-server@0.5.1 test:system
> ./bin/system-tests.sh

Running tests

  ✔ api-search-get › GET /search returns an empty list of results for a collection that does not exist
  ✔ api-search-get › GET /search has a content type of "application/geo+json; charset=utf-8
  ✘ [fail]: api-search-get › /search preserve bbox in next links Rejected promise returned by test
  ✘ [fail]: api-search-get › /search preserve bbox and datetime in next links Rejected promise returned by test
  ✘ [fail]: ingest › The ingest lambda supports ingesting a collection published to SNS Rejected promise returned by test
  ✘ [fail]: ingest › The ingest lambda supports ingesting a collection sourced from S3 Rejected promise returned by test
  ✘ [fail]: ingest › The ingest lambda supports ingesting a collection sourced from http Rejected promise returned by test
  ✘ [fail]: ingest › Reingesting an item maintains the `created` value and updates `updated` Rejected promise returned by test
  ✘ [fail]: ingest › Reingesting an item removes extra fields Rejected promise returned by test
  ✘ [fail]: ingest › Mappings are correctly configured for non-default detected fields Rejected promise returned by test
  ✘ [fail]: api-collection-items-get › before hook Rejected promise returned by test
  ✘ 2 tests remaining in tests/system/test-api-collection-items-get.js
  ✔ api-collection-post › POST /collections creates a collection (1s)
  ✔ api-get-api › GET /api returns OpenAPI description
  ✘ [fail]: api-get-collection › before hook Rejected promise returned by test
  ✘ 2 tests remaining in tests/system/test-api-get-collection.js
  ✘ [fail]: api-get-collections › before hook Rejected promise returned by test
  ✘ 2 tests remaining in tests/system/test-api-get-collections.js
  ✔ api-get-conformance › GET /conformance returns the expected conformsTo list
  ✔ api-get-conformance › GET /conformance has a content type of "application/json
  ✔ api-get-root › GET / includes the default links
  ✔ api-get-root › GET / returns links with the correct endpoint when the API was started with STAC_API_URL set
  ✔ api-get-root › GET / returns links with the correct endpoint if `X-Forwarded-Proto` and `X-Forwarded-Host` are set
  ✔ api-get-root › GET / returns links with the correct endpoint if `X-STAC-Endpoint` is set
  ✘ [fail]: api-item-delete › before hook Rejected promise returned by test
  ✘ 2 tests remaining in tests/system/test-api-item-delete.js
  ✘ [fail]: api-item-get › before hook Rejected promise returned by test
  ✘ 2 tests remaining in tests/system/test-api-item-get.js
  ✘ [fail]: api-item-patch › before hook Rejected promise returned by test
  ✘ 2 tests remaining in tests/system/test-api-item-patch.js
  ✘ [fail]: api-item-post › before hook Rejected promise returned by test
  ✘ 3 tests remaining in tests/system/test-api-item-post.js
  ✘ [fail]: api-item-put › before hook Rejected promise returned by test
  ✘ 5 tests remaining in tests/system/test-api-item-put.js
  ✘ [fail]: api-search-post › before hook Rejected promise returned by test
  ✘ 18 tests remaining in tests/system/test-api-search-post.js
  ─

  api-search-get › /search preserve bbox in next links

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-search-get › /search preserve bbox and datetime in next links

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  ingest › The ingest lambda supports ingesting a collection published to SNS

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  ingest › The ingest lambda supports ingesting a collection sourced from S3

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  ingest › The ingest lambda supports ingesting a collection sourced from http

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  ingest › Reingesting an item maintains the `created` value and updates `updated`

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  ingest › Reingesting an item removes extra fields

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  ingest › Mappings are correctly configured for non-default detected fields

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-collection-items-get › before hook

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-get-collection › before hook

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-get-collections › before hook

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-item-delete › before hook

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-item-get › before hook

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-item-patch › before hook

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-item-post › before hook

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-item-put › before hook

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5



  api-search-post › before hook

  Rejected promise returned by test. Reason:

  Error {
    message: 'not implemented',
  }

  › Readable._read (node_modules/readable-stream/lib/_stream_readable.js:496:22)
  › Readable.read (node_modules/readable-stream/lib/_stream_readable.js:373:10)
  › Readable.resume (node_modules/readable-stream/lib/_stream_readable.js:742:12)
  › Readable.on (node_modules/readable-stream/lib/_stream_readable.js:708:10)
  › Readable.pipe (node_modules/readable-stream/lib/_stream_readable.js:569:7)
  › pipe (node_modules/pump/index.js:56:15)
  › Array.reduce (<anonymous>)
  › pump (node_modules/pump/index.js:79:18)
  › file://src/lib/ingest.js:34:5

  ─

  9 hooks failed
  8 tests failed
